<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" "http://www.springframework.org/dtd/spring-beans.dtd">

<!-- Beans to add to the current Application context definition -->
  
<beans>

    <bean id="remoteRegistrationUrlMapping" class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
        <property name="mappings">
            <props>
                <prop key="module/amrsregistration/start.form">remoteRegistrationWizardForm</prop>
                <prop key="module/amrsregistration/editPatient.form">remoteRegistrationWizardForm</prop>
                <prop key="module/amrsregistration/viewPatient.form">remoteRegistrationWizardForm</prop>
	    </props>
        </property>
    </bean>

    <bean parent="serviceContext">
        <property name="moduleService">
            <list>
                <value>org.openmrs.module.amrsregistration.AmrsRegistrationService</value>
                <bean class="org.springframework.transaction.interceptor.TransactionProxyFactoryBean">
                    <property name="transactionManager"><ref bean="transactionManager"/></property>
                    <property name="target">
                        <bean class="org.openmrs.module.amrsregistration.impl.AmrsRegistrationServiceImpl">
                            <property name="remoteRegistrationDAO">
                                <bean class="org.openmrs.module.amrsregistration.db.hibernate.HibernateAmrsRemoteRegistrationDAO">
                                    <property name="sessionFactory"><ref bean="sessionFactory"/></property>
                                </bean>
                            </property>
                        </bean>
                    </property>
                    <property name="preInterceptors">
                        <list>
                            <ref bean="authorizationInterceptor"/>
                        </list>
                    </property>
                    <property name="transactionAttributeSource">
                        <bean class="org.springframework.transaction.annotation.AnnotationTransactionAttributeSource"/>
                    </property>
                </bean>
            </list>
        </property>
    </bean>


    <!-- Controllers -->
    <bean id="remoteRegistrationWizardForm" class="org.openmrs.module.amrsregistration.web.controller.AmrsRegistrationFormController">
        <!--property name="sessionForm"><value>true</value></property -->
        <!-- property name="bindOnNewForm"><value>false</value></property -->
        <property name="commandName"><value>patient</value></property>
<!--
        <property name="commandClass">
            <value>org.openmrs.Patient</value>
        </property>
-->
        <property name="pages">
            <list>
                <value>/module/amrsregistration/startForm</value>
                <value>/module/amrsregistration/editPatientForm</value>
                <value>/module/amrsregistration/viewPatientForm</value>
            </list>
        </property>
    </bean>
    <!-- </Controllers -->
</beans>